


```sql
DECLARE @TABLE_NAME AS VARCHAR(30) 
DECLARE @RECNAME AS VARCHAR(30)
DECLARE @FROM_RECORD as VARCHAR(30)
DECLARE @PREFX AS VARCHAR(2)
DECLARE @UNDERSCORE AS VARCHAR(1)

SET @TABLE_NAME = 'PS_NQ_Z_C_PHONES'
-- SET @TABLE_NAME = 'PSPRCSRQST'


SET  @PREFX =  SUBSTRING(@TABLE_NAME, 1,2)
SET @UNDERSCORE = SUBSTRING(@TABLE_NAME, 3,1)




select @FROM_RECORD = CASE
						WHEN @PREFX = 'PS' THEN
							CASE 
								WHEN  @UNDERSCORE <> '_' THEN  + @TABLE_NAME
								WHEN  @UNDERSCORE = '_' THEN   +  @TABLE_NAME
							END
						ELSE ' PS_' + @TABLE_NAME
						END 


select @RECNAME = CASE
						WHEN @PREFX = 'PS' THEN
							CASE 
								WHEN  @UNDERSCORE <> '_' THEN   @TABLE_NAME
								WHEN  @UNDERSCORE = '_' THEN   rtrim(substring(@TABLE_NAME,4,30))
							END
						ELSE ' FROM PS_' + @TABLE_NAME
						END 


select @RECNAME, @FROM_RECORD



-- View SQL
SELECT 'SELECT ' + 
STUFF(
		(
			select ',' + FIELDNAME 
			FROM PSRECFIELDDB
			WHERE RECNAME =  @TABLE_NAME  -- UPDATE THIS WHEN USING PS_RECNAME
			ORDER BY FIELDNUM
			FOR XML PATH ('')
		)
	,1,1,'')
+ 'FROM ' + @FROM_RECORD



```